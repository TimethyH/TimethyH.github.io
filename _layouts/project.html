---
layout: default
---

{% if page.thumbnail %}
<!-- Background image with fade effect -->
<div class="project-background" style="--project-bg-image: url('{{ page.thumbnail | relative_url }}');"></div>
{% endif %}

<div class="project-container {% if page.thumbnail %}with-background{% endif %}">
  <a href="{{ '/projects/' | relative_url }}" class="project-back-button">
    ‚Üê Back to Projects
  </a>

  <div class="project-header">
    <h1>{{ page.title }}</h1>
    {% if page.subtitle %}
    <h4 class="project-subtitle">{{ page.subtitle }}</h4>
    {% endif %}

   {% if page.tags %}
    <div class="project-tags">
      {% for tag in page.tags %}
      <span class="project-tag">{{ tag }}</span>
      {% endfor %}
    </div>
    {% endif %}
  </div>

  <article itemscope itemtype="http://schema.org/BlogPosting">
    <div itemprop="articleBody">
      {{ content }}
    </div>
  </article>

  <div class="project-share">
    {%- include share_page.html -%}
  </div>

  <div class="project-comments">
    {%- include blog_post_comments.html -%}
  </div>

  <!-- Project footer signature -->
  <div class="project-footer">
    <div class="project-footer-divider"></div>
    <div class="project-footer-content">
      <a href="{{ '/' | relative_url }}" class="project-footer-signature">
        <div class="signature-name">Timethy Hyman</div>
        <div class="signature-title">Graphics Programmer</div>
      </a>
      <div class="project-footer-social">
        <a href="{{ site.github_username | prepend: 'https://github.com/' }}" target="_blank" rel="noopener" aria-label="GitHub">
          <i class="fab fa-github"></i>
        </a>
        <a href="{{ site.linkedin_username | prepend: 'https://linkedin.com/in/' }}" target="_blank" rel="noopener" aria-label="LinkedIn">
          <i class="fab fa-linkedin"></i>
        </a>
      </div>
    </div>
  </div>

  <!-- Initialize lightGallery for project images -->
  <script type="text/javascript">
    $(document).ready(function() {
      $(".project-media").lightGallery({
        thumbnail: false,
        selector: '.image'
      });
    });
  </script>

  <!-- Intercept videos ASAP before browser starts buffering -->
  <script type="text/javascript">
    (function() {
      const isMobile = window.innerWidth <= 768;
      const isIOS = /iPhone|iPad|iPod/.test(navigator.userAgent);
      if (!isMobile && !isIOS) return; // Only intervene on mobile

      // Use MutationObserver to catch videos as they're added to the DOM
      const observer = new MutationObserver(mutations => {
        mutations.forEach(m => {
          m.addedNodes.forEach(node => {
            if (node.nodeName === 'VIDEO') stripVideo(node);
            if (node.querySelectorAll) {
              node.querySelectorAll('video').forEach(stripVideo);
            }
          });
        });
      });
      observer.observe(document.documentElement, { childList: true, subtree: true });

      function stripVideo(video) {
        const src = video.getAttribute('src');
        if (src) {
          video.setAttribute('data-src', src);
          video.removeAttribute('src');
        }
        video.querySelectorAll('source').forEach(source => {
          const s = source.getAttribute('src');
          if (s) {
            source.setAttribute('data-src', s);
            source.removeAttribute('src');
          }
        });
        video.removeAttribute('autoplay');
        video.setAttribute('preload', 'none');
        video.pause();
      }
    })();
  </script>

  <!-- Lazy load videos with autoplay only on desktop -->
  <script type="text/javascript">
    document.addEventListener('DOMContentLoaded', function() {
      const isMobile = window.innerWidth <= 768;
      const isIOS = /iPhone|iPad|iPod/.test(navigator.userAgent);

      const videoObserver = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          const video = entry.target;

          if (entry.isIntersecting) {
            // Lazy-load the source if not yet set
            const dataSrc = video.getAttribute('data-src');
            if (dataSrc && !video.getAttribute('src')) {
              video.setAttribute('src', dataSrc);
              video.load();
            }
            video.querySelectorAll('source').forEach(source => {
              const ds = source.getAttribute('data-src');
              if (ds && !source.getAttribute('src')) {
                source.setAttribute('src', ds);
              }
            });

            if (!isMobile && !isIOS && video.hasAttribute('autoplay')) {
              video.play().catch(err => console.log('Autoplay prevented:', err));
            }
          } else {
            // Pause when out of view
            video.pause();

            // On mobile: also unload to free memory
            if (isMobile || isIOS) {
              const src = video.getAttribute('src');
              if (src) {
                video.setAttribute('data-src', src);
                video.removeAttribute('src');
                video.load(); // resets the video element, freeing memory
              }
            }
          }
        });
      }, {
        threshold: 0.1,
        rootMargin: '200px'
      });

      document.querySelectorAll('video').forEach(video => {
        videoObserver.observe(video);
      });
    });
  </script>
</div>